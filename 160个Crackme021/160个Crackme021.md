[TOC]

## 查壳

![1554623764490](assets/1554623764490.png)

是Delphi写的，没有壳

## 导出符号

直接拖到IDA里，添加所有的Delphi签名

![1554623801359](assets/1554623801359.png)

然后导出为map文件，再导入到OD，能加快分析速度

![1554623840314](assets/1554623840314.png)

![1554624101592](assets/1554624101592.png)

## 分析程序

![1554624007054](assets/1554624007054.png)

这个程序有两个序列号，

![1554623944944](assets/1554623944944.png)

直接通过DarkDe，找到按钮事件，开始分析算法，管他有几个序列号呢~

## 关键算法分析

整个校验过程如下

![1554627694195](assets/1554627694195.png)

1. 获取用户名 序列号1 序列号2 

![1554627617555](assets/1554627617555.png)

2. 将函数内置的int变量转成字符串和序列号1比较

![1554627735946](assets/1554627735946.png)

3. 将函数内置的int变量转成字符串和序列号2比较

![1554627783543](assets/1554627783543.png)

比较成功则提示正确

![1554627897847](assets/1554627897847.png)

## 结论

- Name为任意值 无校验
- Serial1等于7897302
- Serial2等于9186514

需要相关文件的可以到我的Github下载：https://github.com/TonyChen56/160-Crackme